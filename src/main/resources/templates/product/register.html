<!DOCTYPE html>
<html lang="ko"  xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <title>Insert title here</title>
  <link rel="stylesheet" href="/global.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.7.1.slim.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-bs5.min.css" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.20/summernote-bs5.min.js"></script>
  <script src="/validate.js"></script>
  <style>
    .upper { height: 200px;}
    .border { border: 1px solid gray; margin-right: 10px;}
  </style>
</head>
<body>
<div id="app">
  <header th:replace="~{/fragment/header.html}"> </header>
  <nav th:replace="~{/fragment/nav.html}"></nav>
  <main>
    <section>
      <form action="/seller/product/register" method="post" enctype="multipart/form-data" id="register-form" >
        <table>
          <tr>
            <td>
              <div class="upper border">
                <img class="upper">
              </div>
              <div>
                <input type="file" onchange="showPreview(event);" name="profiies">
              </div>
            </td>
            <td>
              <div class="upper border ">
                <img class="upper">
              </div>
              <div>
                <input type="file" onchange="showPreview(event);" name="profiies" disabled>
              </div>
            </td>
            <td>
              <div class="upper border">
                <img class="upper">
              </div>
              <div>
                <input type="file" onchange="showPreview(event);" name="profiies" disabled>
              </div>
            </td>
          </tr>
        </table>
        <div class="mt-3 mb-3">
          <label class="form-label">상품명:</label>
          <input class="form-control" name="name">
        </div>
        <div class="mt-3 mb-3">
          <label class="form-label">가격:</label>
          <input type="number" class="form-control" name="price" min="1" max="999999">
        </div>
        <div class="mt-3 mb-3">
          <label class="form-label">개수:</label>
          <input type="number" class="form-control" name="name" min="1" max="99">
        </div>
        <div class="mt-3 mb-3">
          <label class="form-label">내용:</label>
          <textarea id="summernote" name="info"></textarea>
        </div>
        <div class="mt-3 mb-3">
          <button type="button" class="btn btn-primary" onclick="doRegister();">작성</button>
        </div>
      </form>
    </section>
  </main>
  <footer th:replace="~{/fragment/footer.html}"></footer>
  <script>
    function showPreview(e) {
      const file = e.target.files[0];
      if(!file || !file.type.startsWith('image/'))
        return;
      const reader = new FileReader();
      reader.onload = function(event) {
        $(e.target).parent().prev().find('img').attr('src', event.target.result);
        $(e.target).closest('td').next().find('input').prop('disabled', false);
      }
       reader.readAsDataURL(file);
    }

    function doRegister() {
      const name = $('#name').val()==='';
      const price = $('#price').val()==='';
      const stock = $('#stock').val()==='';

      const summernote = $('#summernote').summernote('code');
      const info = $('<div>').html(content).text().trim()===''
      if(name || price || stock || info)
        return;
      $('#register-form').submit();
    }
  </script>
</div>
</body>
</html>